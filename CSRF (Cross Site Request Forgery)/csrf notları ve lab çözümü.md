<h1 align="center">IDOR (Insecure Direct Object Reference)</h1>

- **CSRF** zafiyeti bir saldırganın bir kullanıcıyı kandırarak bir linki açmasını, bir butona tıklamasını veya bir bağlantıya tıklamasını sağlamak suretiyle,
  kullanıcının hesabı üzerinde istemeden değişiklik yapmasına veya işlem gerçekleştirmesine olanak tanıyan bir güvenlik açığıdır.
  Bu zafiyet, herhangi bir web uygulamasında oturum açmış bir kullanıcının oturumunu, saldırganın o kullanıcıymış gibi işlemler yapmasına olanak sağlar.
  CSRF açıkları genellikle GET istekleri ve oturum yönetimi işlemlerinin doğru şekilde kontrol edilmemesinden kaynaklanır.
  Bu durum, saldırganın kullanıcı adına istek göndermesine ve yetkisiz işlemler yapmasına imkan tanır.
  Portswigger labları üzerinden konuyu işleyelim


  **Lab 1: CSRF vulnerability with no defenses :**
- Lab da bize bir kullanıcı hesabı vermiş.Bizde o kullanıcı hesabı ile uygulamamıza giriş yapıyoruz.
   Giriş yaptıktan sonra maili csrf zafiyetini kullanarak değiştirmemizi istiyor. 
  
  ![](https://github.com/Yakup-uzn/Web-Security/blob/e9a2f1554f7d8105faf395447e4e1a189d9846cd/CSRF%20(Cross%20Site%20Request%20Forgery)/csrf%20ekran%20resimleri/1.png)

- Hesaba giriş yaptık ve mailimizi değiştirmek için bir istek yolladık.Bu isteğimize bakalım.

  ![](https://github.com/Yakup-uzn/Web-Security/blob/e9a2f1554f7d8105faf395447e4e1a189d9846cd/CSRF%20(Cross%20Site%20Request%20Forgery)/csrf%20ekran%20resimleri/2.png)

- Şimdi bizim bir HTML scripti oluşturmamız gerekiyor.Bu requeste sağ tıklayıp “engagement tool” seçeneğinin üstüne gelip oradan “Generate CSRF PoC” seçeneğini seçiyoruz.Bu bize burpsuite tarafından otomatik html scripti oluşturur.

- **HTML scriptleri oluşturmamızın sebebi**, tarayıcıların kullanıcı farkında olmadan saldırganın belirlediği istekleri gönderebilmesidir. Bu scriptler, kullanıcı oturumu açıkken otomatik olarak çerezleri de göndererek, saldırganın hedef site üzerinde kullanıcı adına işlem yapmasını sağlar. Örneğin, bir img etiketiyle bir GET isteği gönderilip kullanıcının hesabı üzerinde yetkisiz değişiklikler yapılabilir.

```html
<!-- CSRF PoC - generated by Burp Suite Professional -->
<body>
<script>history.pushState('', '', '/')</script>
<form action="https://0a9306f0420ee2cc18f4a7300990028.web-security-academy.net/my-account/change-email" method="POST">
  <input type="hidden" name="email" value="joe1&#64;gmail&#46;com" />
  <input type="submit" value="Submit request" />
</form>
<script>
  document.forms[0].submit();
</script>
</body>
</html>

```

- <form> etiketi, bir HTML formu oluşturur. Bu form, bir POST isteği gönderir ve hedef URL, saldırganın değiştirmek istediği e-posta adresini içeren hedef siteye yönlendirilir.action özelliği, formun gönderileceği URL'yi belirtir.method="POST" özelliği, formun POST isteği ile gönderileceğini belirtir.

- <input type="submit" value="Submit request"  etiketi, formun gönderilmesi için bir buton oluşturur.
  
- <script>document.forms[0].submit();</script> kodu, sayfa yüklendiğinde formun otomatik olarak gönderilmesini sağlar. Bu şekilde, kullanıcı herhangi bir işlem yapmadan form gönderilir.

- Bu kod, kurbanın tarayıcısında çalıştırıldığında, kullanıcının bilgisi ve onayı olmadan belirlenen e-posta adresine POST isteği gönderir. Bu, saldırganın kullanıcı adına yetkisiz değişiklikler yapmasına olanak tanır.





